/*
 * -------------------------------------------------
 *  Nextflow config file for running on JAX's Sumner HPC
 * -------------------------------------------------
 * Base config needed for running with -profile sumner
 */

process {
  executor = 'slurm'
  beforeScript = 'module load singularity'
}
singularity {
  enabled = true
  cacheDir = "$HOME/.singularity_cache"
  autoMounts = true
}

process {
    disk = "200 GB"
    errorStrategy = { task.attempt <= 100 ? 'retry' : 'ignore' }
    maxRetries = 100
    container  = 'gcr.io/nextflow-250616/splicing-pipelines-nf'

    withName: 'fastqc' {
        cpus = 4
        memory = 24.GB 
    }
    withName: 'trimmomatic' {
        cpus = 3
        memory = 16.GB
    }
    withName: 'star' {
        cpus = 10
        memory = 60.GB
    }
    withName: 'stringtie' {
        cpus = 4
        memory = 24.GB 
    }
    withName: 'stringtie_merge' {
        cpus = 4
        memory = 24.GB 
    }
    withName: 'rmats' {
        cpus = 10
        memory = 60.GB
        container = 'gcr.io/nextflow-250616/rmats:4.0.2'
    }
    withName: 'paired_rmats' {
        cpus = 10
        memory = 60.GB
        container = 'gcr.io/nextflow-250616/rmats:4.0.2'
    }
    withName: 'multiqc' {
        cpus = 4
        memory = 24.GB
    }
}
